(()=>{"use strict";var e={614:(e,t,s)=>{var a;s.r(t),s.d(t,{NIL:()=>q,parse:()=>g,stringify:()=>c,v1:()=>v,v3:()=>F,v4:()=>C,v5:()=>A,validate:()=>o,version:()=>O});var n=new Uint8Array(16);function i(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(n)}const r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,o=function(e){return"string"==typeof e&&r.test(e)};for(var d=[],l=0;l<256;++l)d.push((l+256).toString(16).substr(1));const c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase();if(!o(s))throw TypeError("Stringified UUID is invalid");return s};var u,p,h=0,m=0;const v=function(e,t,s){var a=t&&s||0,n=t||new Array(16),r=(e=e||{}).node||u,o=void 0!==e.clockseq?e.clockseq:p;if(null==r||null==o){var d=e.random||(e.rng||i)();null==r&&(r=u=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==o&&(o=p=16383&(d[6]<<8|d[7]))}var l=void 0!==e.msecs?e.msecs:Date.now(),v=void 0!==e.nsecs?e.nsecs:m+1,g=l-h+(v-m)/1e4;if(g<0&&void 0===e.clockseq&&(o=o+1&16383),(g<0||l>h)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=l,m=v,p=o;var f=(1e4*(268435455&(l+=122192928e5))+v)%4294967296;n[a++]=f>>>24&255,n[a++]=f>>>16&255,n[a++]=f>>>8&255,n[a++]=255&f;var L=l/4294967296*1e4&268435455;n[a++]=L>>>8&255,n[a++]=255&L,n[a++]=L>>>24&15|16,n[a++]=L>>>16&255,n[a++]=o>>>8|128,n[a++]=255&o;for(var y=0;y<6;++y)n[a+y]=r[y];return t||c(n)},g=function(e){if(!o(e))throw TypeError("Invalid UUID");var t,s=new Uint8Array(16);return s[0]=(t=parseInt(e.slice(0,8),16))>>>24,s[1]=t>>>16&255,s[2]=t>>>8&255,s[3]=255&t,s[4]=(t=parseInt(e.slice(9,13),16))>>>8,s[5]=255&t,s[6]=(t=parseInt(e.slice(14,18),16))>>>8,s[7]=255&t,s[8]=(t=parseInt(e.slice(19,23),16))>>>8,s[9]=255&t,s[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,s[11]=t/4294967296&255,s[12]=t>>>24&255,s[13]=t>>>16&255,s[14]=t>>>8&255,s[15]=255&t,s};function f(e,t,s){function a(e,a,n,i){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],s=0;s<e.length;++s)t.push(e.charCodeAt(s));return t}(e)),"string"==typeof a&&(a=g(a)),16!==a.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var r=new Uint8Array(16+e.length);if(r.set(a),r.set(e,a.length),(r=s(r))[6]=15&r[6]|t,r[8]=63&r[8]|128,n){i=i||0;for(var o=0;o<16;++o)n[i+o]=r[o];return n}return c(r)}try{a.name=e}catch(e){}return a.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",a.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",a}function L(e){return 14+(e+64>>>9<<4)+1}function y(e,t){var s=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(s>>16)<<16|65535&s}function w(e,t,s,a,n,i){return y((r=y(y(t,e),y(a,i)))<<(o=n)|r>>>32-o,s);var r,o}function E(e,t,s,a,n,i,r){return w(t&s|~t&a,e,t,n,i,r)}function M(e,t,s,a,n,i,r){return w(t&a|s&~a,e,t,n,i,r)}function b(e,t,s,a,n,i,r){return w(t^s^a,e,t,n,i,r)}function S(e,t,s,a,n,i,r){return w(s^(t|~a),e,t,n,i,r)}const F=f("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var s=0;s<t.length;++s)e[s]=t.charCodeAt(s)}return function(e){for(var t=[],s=32*e.length,a="0123456789abcdef",n=0;n<s;n+=8){var i=e[n>>5]>>>n%32&255,r=parseInt(a.charAt(i>>>4&15)+a.charAt(15&i),16);t.push(r)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[L(t)-1]=t;for(var s=1732584193,a=-271733879,n=-1732584194,i=271733878,r=0;r<e.length;r+=16){var o=s,d=a,l=n,c=i;s=E(s,a,n,i,e[r],7,-680876936),i=E(i,s,a,n,e[r+1],12,-389564586),n=E(n,i,s,a,e[r+2],17,606105819),a=E(a,n,i,s,e[r+3],22,-1044525330),s=E(s,a,n,i,e[r+4],7,-176418897),i=E(i,s,a,n,e[r+5],12,1200080426),n=E(n,i,s,a,e[r+6],17,-1473231341),a=E(a,n,i,s,e[r+7],22,-45705983),s=E(s,a,n,i,e[r+8],7,1770035416),i=E(i,s,a,n,e[r+9],12,-1958414417),n=E(n,i,s,a,e[r+10],17,-42063),a=E(a,n,i,s,e[r+11],22,-1990404162),s=E(s,a,n,i,e[r+12],7,1804603682),i=E(i,s,a,n,e[r+13],12,-40341101),n=E(n,i,s,a,e[r+14],17,-1502002290),s=M(s,a=E(a,n,i,s,e[r+15],22,1236535329),n,i,e[r+1],5,-165796510),i=M(i,s,a,n,e[r+6],9,-1069501632),n=M(n,i,s,a,e[r+11],14,643717713),a=M(a,n,i,s,e[r],20,-373897302),s=M(s,a,n,i,e[r+5],5,-701558691),i=M(i,s,a,n,e[r+10],9,38016083),n=M(n,i,s,a,e[r+15],14,-660478335),a=M(a,n,i,s,e[r+4],20,-405537848),s=M(s,a,n,i,e[r+9],5,568446438),i=M(i,s,a,n,e[r+14],9,-1019803690),n=M(n,i,s,a,e[r+3],14,-187363961),a=M(a,n,i,s,e[r+8],20,1163531501),s=M(s,a,n,i,e[r+13],5,-1444681467),i=M(i,s,a,n,e[r+2],9,-51403784),n=M(n,i,s,a,e[r+7],14,1735328473),s=b(s,a=M(a,n,i,s,e[r+12],20,-1926607734),n,i,e[r+5],4,-378558),i=b(i,s,a,n,e[r+8],11,-2022574463),n=b(n,i,s,a,e[r+11],16,1839030562),a=b(a,n,i,s,e[r+14],23,-35309556),s=b(s,a,n,i,e[r+1],4,-1530992060),i=b(i,s,a,n,e[r+4],11,1272893353),n=b(n,i,s,a,e[r+7],16,-155497632),a=b(a,n,i,s,e[r+10],23,-1094730640),s=b(s,a,n,i,e[r+13],4,681279174),i=b(i,s,a,n,e[r],11,-358537222),n=b(n,i,s,a,e[r+3],16,-722521979),a=b(a,n,i,s,e[r+6],23,76029189),s=b(s,a,n,i,e[r+9],4,-640364487),i=b(i,s,a,n,e[r+12],11,-421815835),n=b(n,i,s,a,e[r+15],16,530742520),s=S(s,a=b(a,n,i,s,e[r+2],23,-995338651),n,i,e[r],6,-198630844),i=S(i,s,a,n,e[r+7],10,1126891415),n=S(n,i,s,a,e[r+14],15,-1416354905),a=S(a,n,i,s,e[r+5],21,-57434055),s=S(s,a,n,i,e[r+12],6,1700485571),i=S(i,s,a,n,e[r+3],10,-1894986606),n=S(n,i,s,a,e[r+10],15,-1051523),a=S(a,n,i,s,e[r+1],21,-2054922799),s=S(s,a,n,i,e[r+8],6,1873313359),i=S(i,s,a,n,e[r+15],10,-30611744),n=S(n,i,s,a,e[r+6],15,-1560198380),a=S(a,n,i,s,e[r+13],21,1309151649),s=S(s,a,n,i,e[r+4],6,-145523070),i=S(i,s,a,n,e[r+11],10,-1120210379),n=S(n,i,s,a,e[r+2],15,718787259),a=S(a,n,i,s,e[r+9],21,-343485551),s=y(s,o),a=y(a,d),n=y(n,l),i=y(i,c)}return[s,a,n,i]}(function(e){if(0===e.length)return[];for(var t=8*e.length,s=new Uint32Array(L(t)),a=0;a<t;a+=8)s[a>>5]|=(255&e[a/8])<<a%32;return s}(e),8*e.length))})),C=function(e,t,s){var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){s=s||0;for(var n=0;n<16;++n)t[s+n]=a[n];return t}return c(a)};function T(e,t,s,a){switch(e){case 0:return t&s^~t&a;case 1:case 3:return t^s^a;case 2:return t&s^t&a^s&a}}function k(e,t){return e<<t|e>>>32-t}const A=f("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],s=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var a=unescape(encodeURIComponent(e));e=[];for(var n=0;n<a.length;++n)e.push(a.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var i=e.length/4+2,r=Math.ceil(i/16),o=new Array(r),d=0;d<r;++d){for(var l=new Uint32Array(16),c=0;c<16;++c)l[c]=e[64*d+4*c]<<24|e[64*d+4*c+1]<<16|e[64*d+4*c+2]<<8|e[64*d+4*c+3];o[d]=l}o[r-1][14]=8*(e.length-1)/Math.pow(2,32),o[r-1][14]=Math.floor(o[r-1][14]),o[r-1][15]=8*(e.length-1)&4294967295;for(var u=0;u<r;++u){for(var p=new Uint32Array(80),h=0;h<16;++h)p[h]=o[u][h];for(var m=16;m<80;++m)p[m]=k(p[m-3]^p[m-8]^p[m-14]^p[m-16],1);for(var v=s[0],g=s[1],f=s[2],L=s[3],y=s[4],w=0;w<80;++w){var E=Math.floor(w/20),M=k(v,5)+T(E,g,f,L)+y+t[E]+p[w]>>>0;y=L,L=f,f=k(g,30)>>>0,g=v,v=M}s[0]=s[0]+v>>>0,s[1]=s[1]+g>>>0,s[2]=s[2]+f>>>0,s[3]=s[3]+L>>>0,s[4]=s[4]+y>>>0}return[s[0]>>24&255,s[0]>>16&255,s[0]>>8&255,255&s[0],s[1]>>24&255,s[1]>>16&255,s[1]>>8&255,255&s[1],s[2]>>24&255,s[2]>>16&255,s[2]>>8&255,255&s[2],s[3]>>24&255,s[3]>>16&255,s[3]>>8&255,255&s[3],s[4]>>24&255,s[4]>>16&255,s[4]>>8&255,255&s[4]]})),q="00000000-0000-0000-0000-000000000000",O=function(e){if(!o(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,s),i.exports}s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{class e{constructor(e){this.url=e,this.contentTypeHeader={"Content-Type":"application/json"}}load(){return fetch(this.url)}add(e){return fetch(this.url,{body:JSON.stringify(e),method:"POST",headers:this.contentTypeHeader})}addFavorite(e){return fetch(this.url,{body:JSON.stringify(e),method:"POST",headers:this.contentTypeHeader})}addNewMessage(e){return fetch(this.url,{body:JSON.stringify(e),method:"POST",headers:this.contentTypeHeader})}remove(e){return fetch(`${this.url}/${e}`,{method:"DELETE"})}}class t{constructor(){this.fileEl=document.querySelector("[data-id=file]"),this.form=document.querySelector("[data-id=upload-form]"),this.overlapEl=document.querySelector("[data-id=overlap]"),this.dropEl=document.querySelector("[data-id=drop-area]"),this.messageList=document.querySelector("[data-id=messageList]")}create(){this.loadTasks(),this.addListeners(),this.addDnDListenters()}addImgs(e){this.idCount=0,this.fileEl=document.querySelector("[data-id=file]");for(let t=0;t<e.length;t+=1){const s=document.createElement("span");s.className="message",s.id=this.idCount;const a=document.createElement("img");a.src=URL.createObjectURL(e[t]),a.className="image";const n=new FormData(this.form),i=new XMLHttpRequest;i.open("POST","https://ahj-diploma-server.herokuapp.com"),i.addEventListener("load",(()=>{200===i.status&&(URL.revokeObjectURL(`https://ahj-diploma-server.herokuapp.com${i.response}`),this.idCount+=1,this.messageList.appendChild(s),s.appendChild(a),this.messageList.scrollTop=this.messageList.scrollHeight,this.fileEl.value="")})),i.send(n)}}addListeners(){this.overlapEl.addEventListener("click",(()=>{this.fileEl.dispatchEvent(new MouseEvent("click"))})),this.fileEl.addEventListener("change",(e=>{const t=Array.from(e.currentTarget.files);this.addImgs(t)}))}addClipListener(){document.querySelector("[data-id=clipPhoto]").addEventListener("click",(()=>{this.fileEl.dispatchEvent(new MouseEvent("click"))}))}addDnDListenters(){this.dropEl.addEventListener("dragover",(e=>{e.preventDefault()})),this.dropEl.addEventListener("drop",(e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);this.addImgs(t)}))}loadTasks(){const t=new e("https://ahj-diploma-server/imagesArr");!async function(e){const s=await t.load(),a=await s.json();for(let t=0;t<a.length;t+=1)if(".gitkeep"!==a[t].name){const s=document.createElement("span");s.className="message",s.id=a[t].name;const n=document.createElement("img");n.src=`https://ahj-diploma-server.herokuapp.com/${a[t].name}`,n.className="image",e.appendChild(s),s.appendChild(n),e.scrollTop=e.scrollHeight}}(this.messageList)}}class a{constructor(e){this.positionByUser=null,this.positionByGeo=null,this.parent=e}create(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:s}=e.coords;this.positionByGeo=`${t.toFixed(5)}, ${s.toFixed(5)}`,this.createMessage(this.positionByGeo)}),(()=>{}))}createMessage(t){this.geoposition=t;const a=document.createElement("span");a.className="message";const n=s(614);a.id=n.v4(),a.innerHTML=`\n    Мои координаты: [<span data-id="geopos" class="geopos">${this.geoposition}</span>]`,this.parent.appendChild(a),this.parent.scrollTop=this.parent.scrollHeight;const i=new e("https://ahj-diploma-server.herokuapp.com/newMessage");this.toServerNewMessage(a.id,a.textContent,i)}toServerNewMessage(e,t,s){const a=e,n=t,i=s;!async function(){await i.addNewMessage({id:a,text:n})}()}}class n{constructor(){this.form=document.querySelector("[data-id=formFile]"),this.fileEl=document.querySelector("[data-id=fileFile]"),this.overlapEl=document.querySelector("[data-id=overlapFile]"),this.fileContainer=document.querySelector("[data-id=file-containerFile]"),this.messageList=document.querySelector("[data-id=messageList]"),this.files=[],this.idCount=0}create(){this.addListenerOverlapEl(),this.addListenerFileEl()}downloadFile(e){const t=this.files[e],s=document.createElement("a");s.download=t.name,s.href=URL.createObjectURL(t),s.rel="noopener",setTimeout((()=>URL.revokeObjectURL(s.href)),6e4),setTimeout((()=>s.dispatchEvent(new MouseEvent("click"))))}sizeConverter(e){return`${(e/1024/1024).toFixed(1)} Mb`}addFiles(e){for(let t=0;t<e.length;t+=1){const s=document.createElement("span");s.className="message",s.id=this.idCount,this.idCount+=1,s.setAttribute("messageType","regular"),s.innerHTML=`\n      <span class="name">${e[t].name}</span>\n      <span class="size">${this.sizeConverter(e[t].size)}</span>\n      <span class="link">Download</span>`,this.messageList.appendChild(s),this.messageList.scrollTop=this.messageList.scrollHeight,this.addDownloadListener(s.id);const a=new FormData(this.form),n=new XMLHttpRequest;n.open("POST","https://ajh-diploma.herokuapp.com"),n.addEventListener("load",(()=>{200===n.status&&URL.revokeObjectURL(`https://ajh-diploma.herokuapp.com${n.response}`)})),n.send(a),this.fileEl.value=""}}addListenerOverlapEl(){this.overlapEl.addEventListener("click",(()=>{this.fileEl.dispatchEvent(new MouseEvent("click"))}))}addListenerFileEl(){this.fileEl.addEventListener("change",(e=>{this.files=Array.from(e.currentTarget.files),this.overlapEl.style.display="none",this.addFiles(this.files)}))}addDownloadListener(e){document.getElementById(e).addEventListener("click",(()=>{this.downloadFile(e)}))}}const i=s(614),r=document.querySelector("[data-id=widgetHolder]");new class{constructor(e){this.parent=e,this.messageList=document.querySelector("[data-id=messageList]"),this.clipBtn=document.querySelector("[data-id=clip]"),this.uploadForm=document.querySelector("[data-id=upload-form]"),this.formFile=document.querySelector("[data-id=formFile]"),this.onlyOneBtnsHolder=!0,this.favoriteMessagesList=!1,this.pinnedOpen=!1,this.pinnedMessage=null}create(){this.makingBody()}makingBody(){this.addListeners(),(new t).create(),this.loadMessages()}addListeners(){const t=document.querySelector("[data-id=burgerMenu]");let s=!1,a=!1;t.addEventListener("click",(()=>{if(s||a)s&&!a&&(t.firstChild.remove(),s=!1);else{const e=document.createElement("ul");e.className="burgerMenuUl",e.innerHTML='\n        <li data-id="pinGeolocation" class="burgerMenuList">Прикрепить геолокацию</li>\n        <li data-id="favorite" class="burgerMenuList">Избранные сообщения</li>',t.appendChild(e),s=!0,a=!1,this.addEventListenersBurger()}})),this.clipBtn.addEventListener("click",(()=>{if(a||s)a&&!s&&(t.firstChild.remove(),a=!1,this.uploadForm.classList.remove("imgFormShow"),this.uploadForm.classList.add("imgForm"));else{const e=document.createElement("ul");e.className="burgerMenuUl",e.innerHTML='\n        <li data-id="clipPhoto" class="burgerMenuList">Прикрепить фотографию</li>\n        <li data-id="clipFile" class="burgerMenuList">Прикрепить документ</li>',t.appendChild(e),a=!0,s=!1,this.addListenersForClipFunctions()}})),this.messageList.addEventListener("click",(e=>{if("image"===e.target.classList.value){const t=e;t.target.classList.value="imageZoom",t.target.parentElement.classList.value="messageZoomImg"}else if("imageZoom"===e.target.classList.value){const t=e;t.target.classList.value="image",t.target.parentElement.classList.value="message"}else if("geopos"===e.target.classList.value){const t=document.createElement("INPUT");t.setAttribute("type","text"),t.setAttribute("data-id","copy"),t.setAttribute("value",e.target.textContent),document.body.appendChild(t),document.querySelector("[data-id=copy]").select(),document.execCommand("copy"),t.remove()}})),this.messageList.addEventListener("mouseover",(e=>{if("message"===e.target.classList.value&&this.onlyOneBtnsHolder||"message favorite"===e.target.classList.value&&this.onlyOneBtnsHolder){this.onlyOneBtnsHolder=!1;const t=e.target,s=document.createElement("div");s.className="btnsHolder btnsHolderShow",s.innerHTML='\n          <span data-id="btnFavorite" class="btnFavorite">&#10084;</span>\n          <span data-id="btnPin" class="btnPin">&#9733;</span>',t.appendChild(s),this.addListenersFavorite(t,!1),t.addEventListener("mouseleave",(()=>{s.classList.remove("btnsHolderShow"),s.classList.add("btnsHolderHide"),setTimeout((()=>{s.remove(),this.onlyOneBtnsHolder=!0}),100)}))}})),this.messageList.addEventListener("scroll",(()=>{null!==this.pinnedMessage&&(this.pinnedMessage.style.top=`${this.messageList.scrollTop}px`)}));const n=document.querySelector("[data-id=messageInput]");n.addEventListener("keypress",(t=>{if(13===t.charCode){const t=document.createElement("span");t.className="message",t.id=i.v4(),t.setAttribute("messageType","regular");let s=n.value;const a=/((([A-Za-z]{3,9}):\/\/)*?([-;:&=\+\$,\w]+@{1})?(([-A-Za-z0-9]+\.)+[A-Za-z]{2,3})(:\d+)?((\/[-\+~%\/\.\w]+)?\/?([&?][-\+=&;%@\.\w]+)?(#[\w]+)?)?)/gim;s=s.replace(a,'<a class="link" href="$1">$1</a>'),t.innerHTML=s,this.messageList.appendChild(t),this.messageList.scrollTop=this.messageList.scrollHeight,n.value="";const r=new e("https://ahj-diploma-server.herokuapp.com/newMessage");this.toServerNewMessage(t.id,t.textContent,r)}}))}addListenersForClipFunctions(){const e=document.querySelector("[data-id=clipPhoto]"),s=document.querySelector("[data-id=clipFile]");e.addEventListener("click",(()=>{(new t).addClipListener(),this.uploadForm.classList.remove("imgForm"),this.uploadForm.classList.add("imgFormShow")})),s.addEventListener("click",(()=>{(new n).create(),this.formFile.classList.remove("imgForm"),this.formFile.classList.add("imgFormShow")}))}addEventListenersBurger(){this.pinGeolocation=document.querySelector("[data-id=pinGeolocation]"),this.pinGeolocation.addEventListener("click",(()=>{new a(this.messageList).create()})),this.favoriteMessageBtn=document.querySelector("[data-id=favorite]"),this.favoriteMessageBtn.addEventListener("click",(()=>{this.favoriteMessagesList?(document.querySelector("[data-id=favoriteMessagesList]").remove(),this.favoriteMessagesList=!1):(this.loadFavoriteMessages(),this.favoriteMessagesList=!0)}))}addListenersFavorite(t,s){const a=t;document.querySelector("[data-id=btnPin]").addEventListener("click",(()=>{null!==this.pinnedMessage&&(this.pinnedMessage.classList.remove("pinned"),this.pinnedMessage.setAttribute("style",""),this.pinnedMessage.classList.remove("pinnedOpen"),this.pinnedMessage=null),a.classList.add("pinned"),this.pinnedMessage=a,setTimeout((()=>{this.addListenerPinBtn()}),10),this.deletePinEvent()})),s||document.querySelector("[data-id=btnFavorite]").addEventListener("click",(()=>{if("regular"===a.getAttribute("messageType")){a.setAttribute("messageType","favorite"),a.classList.add("favorite");const t=new e("https://ahj-diploma-server.herokuapp.com/addFavorite");this.toServerNewFavorite(a.id,a.textContent,t)}else{a.setAttribute("messageType","regular"),a.classList.remove("favorite");const t=a.id,s=new e("https://ahj-diploma-server.herokuapp.com/dellFavorite");this.removeElById(s,t)}}))}deletePinEvent(){this.pinnedMessage.addEventListener("dblclick",(()=>{this.pinnedMessage.classList.remove("pinned"),this.pinnedMessage.setAttribute("style",""),this.pinnedMessage.classList.remove("pinnedOpen"),this.pinnedMessage=null}))}addListenerPinBtn(){this.pinnedMessage.addEventListener("click",(()=>{this.pinnedOpen?(this.pinnedMessage.classList.add("pinnedOpen"),this.pinnedOpen=!1):(this.pinnedMessage.classList.remove("pinnedOpen"),this.pinnedOpen=!0)}))}toServerNewMessage(e,t,s){const a=e,n=t,i=s;!async function(){await i.addNewMessage({id:a,text:n})}()}toServerNewFavorite(e,t,s){const a=e,n=t,i=s;!async function(){await i.addFavorite({id:a,text:n})}()}loadFavoriteMessages(){const t=new e("https://ahj-diploma-server.herokuapp.com/showFavorite");this.fromServerFavorite(t)}loadMessages(){const t=new e("https://ahj-diploma-server.herokuapp.com/showMessages");this.fromServerMessages(t)}fromServerFavorite(e){const t=e;!async function(){const e=await t.load(),s=await e.json(),a=document.createElement("div");a.className="favoriteMessagesList",a.setAttribute("data-id","favoriteMessagesList"),document.querySelector("[data-id=messageList]").appendChild(a);for(let e=0;e<s.length;e+=1){let t=s[e].text;const n=document.createElement("span");n.id=s[e].id,n.classList="message favorite",n.setAttribute("messageType","favorite"),n.textContent=t;const i=/((([A-Za-z]{3,9}):\/\/)*?([-;:&=\+\$,\w]+@{1})?(([-A-Za-z0-9]+\.)+[A-Za-z]{2,3})(:\d+)?((\/[-\+~%\/\.\w]+)?\/?([&?][-\+=&;%@\.\w]+)?(#[\w]+)?)?)/gim;t=t.replace(i,'<a class="link" href="$1">$1</a>'),n.innerHTML=t,a.appendChild(n)}}()}fromServerMessages(e){const t=e;!async function(){const e=await t.load(),s=await e.json(),a=document.querySelector("[data-id=messageList]");for(let e=0;e<s.length;e+=1){let t=s[e].text;const n=document.createElement("span");n.id=s[e].id,"favorite"===s[e].messageType?n.classList="message favorite":n.classList="message",n.setAttribute("messageType","regular");const i=/((([A-Za-z]{3,9}):\/\/)*?([-;:&=\+\$,\w]+@{1})?(([-A-Za-z0-9]+\.)+[A-Za-z]{2,3})(:\d+)?((\/[-\+~%\/\.\w]+)?\/?([&?][-\+=&;%@\.\w]+)?(#[\w]+)?)?)/gim;t=t.replace(i,'<a class="link" href="$1">$1</a>'),n.innerHTML=t,a.appendChild(n)}}()}removeElById(e,t){!async function(t){await e.remove(t)}(t)}}(r).create()})()})();